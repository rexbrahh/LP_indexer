---
title: "decoder/orca_whirlpool/proto.go"
---

This page is an **annotated source reference**. Code blocks are imported from the repository at build time.

## What this file is

`decoder/orca_whirlpool/proto.go` projects the Orca decoder’s `SwapEvent` struct
into the repository’s canonical protobuf message (`dex.sol.v1.SwapEvent`).

This is the bridge between “decoder-local types” and “pipeline-wide contracts”.

## Why this file exists

Downstream publishers and sinks operate on canonical protobuf messages, not on
decoder-specific structs.

Keeping the projection logic in a dedicated file:

- makes the mapping explicit and reviewable
- isolates protobuf dependencies from the core decoding types
- allows the decoder to evolve internally while preserving the pipeline contract

## Full source

```go title="decoder/orca_whirlpool/proto.go" file=<rootDir>/decoder/orca_whirlpool/proto.go showLineNumbers
```

## Walkthrough (by declaration)

### package orca_whirlpool

```go title="package orca_whirlpool" file=<rootDir>/decoder/orca_whirlpool/proto.go#L1-L1 showLineNumbers
```

**What:** Declares the Orca Whirlpool decoder package.

**How:** This file adds a `ToProto` method on `SwapEvent` for downstream use.

**Why:** A method-based conversion keeps call sites concise and makes it easy to keep decoder output consistent.

### imports

```go title="imports" file=<rootDir>/decoder/orca_whirlpool/proto.go#L3-L3 showLineNumbers
```

**What:** Canonical protobuf contract for swap events.

**How:** Imports `dexv1.SwapEvent` from generated protobuf bindings.

**Why:** The rest of the pipeline publishes/consumes protobuf messages; conversion targets that schema.

### const (solanaChainID)

**Symbols:** solanaChainID

```go title="const (solanaChainID)" file=<rootDir>/decoder/orca_whirlpool/proto.go#L5-L5 showLineNumbers
```

**What:** Constant Solana chain ID used in emitted protobuf events.

**How:** Written into `dexv1.SwapEvent.ChainId`.

**Why:** Keeps the canonical event contract multi-chain friendly even when focusing on Solana.

### func (*SwapEvent) ToProto

**Symbols:** ToProto

```go title="func (*SwapEvent) ToProto" file=<rootDir>/decoder/orca_whirlpool/proto.go#L7-L37 showLineNumbers
```

**What:** Converts an Orca `SwapEvent` into the canonical protobuf `dexv1.SwapEvent`.

**How:** The method:

- returns `nil` for a nil receiver
- maps core identifiers:
  - chain id, slot, signature
  - program id (`WhirlpoolProgramID`)
  - pool id and base/quote mint IDs (from `BaseAsset`/`QuoteAsset`)
- marks the event as `Provisional = true`

Several fields are intentionally left as zero values today (decimals, amounts, sqrt price, reserves) and are expected to be wired in as the canonical decoder integration matures.

**Why:** A stable protobuf message format is required for JetStream publishing and sink ingestion. Even partial mappings are useful to keep integration points consistent while decoder fidelity improves.
